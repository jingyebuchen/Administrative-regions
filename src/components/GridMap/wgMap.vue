<template>
  <div class="grid_map" id="map">
    <div id="mouse-position"></div>
    <div id="popup" class="ol-popup">
      <div id="popup-content"></div>
    </div>
  </div>
</template>

<script>
  import CommonFunc from './js/calclonlat'
  import Map from 'ol/Map.js';
  import View from 'ol/View.js';
  import TileLayer from 'ol/layer/Tile.js';
  import TileWMS from 'ol/source/TileWMS.js';
  import XYZSource from 'ol/source/XYZ';
  import Graticule from 'ol/Graticule.js';
  import {
    defaults as defaultControls,
    ScaleLine,
    FullScreen,
    MousePosition
  } from 'ol/control.js';
  import {
    createStringXY
  } from 'ol/coordinate.js';
  import {
    fromLonLat,
    transform,
    toLonLat
  } from 'ol/proj';
  import {
    Circle as CircleStyle,
    Fill,
    Stroke,
    Icon,
    Style
  } from 'ol/style.js';
  import {
    Vector as VectorLayer
  } from 'ol/layer.js';
  import {
    OSM,
    Vector as VectorSource
  } from 'ol/source.js';
  import Feature from 'ol/Feature.js';
  import Point from 'ol/geom/Point.js';
  import {
    LineString,
    Polygon
  } from 'ol/geom.js';
  import {
    getDistance
  } from 'ol/sphere.js';
  import Draw, {
    createRegularPolygon,
    createBox
  } from 'ol/interaction/Draw.js';
  import {
    defaults as defaultInteractions,
    Select,
    Translate
  } from 'ol/interaction.js';
  import {
    click,
    pointerMove,
    altKeyOnly
  } from 'ol/events/condition.js';
  import GeoJSON from 'ol/format/GeoJSON';
  import EsriJSON from 'ol/format/EsriJSON';
  import * as turf from '@turf/turf';
  import Overlay from 'ol/Overlay.js';

  let map;
  let featuregrid = [];
  let geojson = [];

  export default {
    name: 'GridMap',
    data() {
      return {

      }
    },
    mounted() {
      let _this = this;
      _this.initMap();
    },
    methods: {
      initMap() {
        let _this = this;

        function createStyle(src, img) {
          return new Style({
            image: new Icon( /** @type {module:ol/style/Icon~Options} */ ({
              anchor: [0.5, 0.5],
              crossOrigin: 'anonymous',
              src: src,
              img: img,
              scale: 0.1,
              imgSize: img ? [img.width, img.height] : undefined
            }))
          });
        }
        var mousePositionControl = new MousePosition({
          coordinateFormat: createStringXY(4), //坐标格式
          projection: 'EPSG:4326', //地图投影坐标系
          className: 'custom-mouse-position', //坐标信息显示样式
          // 显示鼠标位置信息的目标容器
          target: document.getElementById('mouse-position'),
          undefinedHTML: '&nbsp' //未定义坐标的标记
        });
        var point00 = [114.30, 30.60];
        var end11 = [114.90, 30.30];
        //======================================网格============================
        var linestyle = new Style({
          stroke: new Stroke({
            color: '#6A5ACD',
            width: 1
          }),
          fill: new Fill({
            color: 'rgba(135,206,250,0.2)'
          })
        })
        var gridstyle = new Style({
          stroke: new Stroke({
            color: '#ff0000',
            width: 1
          }),
          fill: new Fill({
            color: 'rgba(0,255,0,0.2)'
          })
        })
        var onlystyle = new Style({
          stroke: new Stroke({
            color: '#0000ff',
            width: 1
          }),
          fill: new Fill({
            color: 'rgba(0,255,255,0.4)'
          })
        })
        var langfang_beisan = [117.18038, 40.08293, 117.17907, 40.08370, 117.17851, 40.08348, 117.17893, 40.08256,
          117.17889, 40.08234, 117.17758, 40.08121, 117.17651, 40.07980, 117.17570, 40.07974, 117.17523, 40.07920,
          117.17508, 40.07878, 117.17548, 40.07793, 117.17584, 40.07755, 117.17852, 40.07615, 117.17946, 40.07549,
          117.17997, 40.07489, 117.18000, 40.07455, 117.17991, 40.07414, 117.17947, 40.07379, 117.17773, 40.07345,
          117.17748, 40.07326, 117.17714, 40.07076, 117.17379, 40.06818, 117.17399, 40.06927, 117.17380, 40.06950,
          117.17165, 40.06980, 117.17092, 40.07046, 117.17066, 40.07040, 117.17031, 40.06984, 117.16912, 40.07032,
          117.16893, 40.07080, 117.16920, 40.07150, 117.16907, 40.07176, 117.16864, 40.07171, 117.16793, 40.07200,
          117.16756, 40.07149, 117.16710, 40.07135, 117.16639, 40.07187, 117.16565, 40.07288, 117.16479, 40.07272,
          117.16263, 40.07325, 117.16110, 40.07384, 117.15852, 40.07533, 117.15810, 40.07531, 117.15788, 40.07463,
          117.15766, 40.07450, 117.15478, 40.07500, 117.15425, 40.07519, 117.15179, 40.07675, 117.14988, 40.07730,
          117.14967, 40.07712, 117.15000, 40.07679, 117.15197, 40.07608, 117.15293, 40.07551, 117.15332, 40.07517,
          117.15368, 40.07443, 117.15179, 40.07052, 117.14975, 40.06797, 117.14867, 40.06736, 117.14735, 40.06724,
          117.14502, 40.06672, 117.14116, 40.06491, 117.13883, 40.06461, 117.13621, 40.06461, 117.13362, 40.06298,
          117.13269, 40.06266, 117.12984, 40.06288, 117.12832, 40.06260, 117.12192, 40.06417, 117.12069, 40.06519,
          117.11993, 40.06670, 117.11931, 40.06739, 117.11879, 40.06777, 117.11652, 40.06875, 117.11296, 40.07101,
          117.11215, 40.07097, 117.11142, 40.07029, 117.11117, 40.06973, 117.11088, 40.06952, 117.11038, 40.06962,
          117.10963, 40.07028, 117.10817, 40.07090, 117.10489, 40.07074, 117.10371, 40.07050, 117.10198, 40.07039,
          117.10041, 40.07051, 117.09822, 40.07143, 117.09745, 40.07195, 117.09891, 40.07314, 117.09876, 40.07334,
          117.09816, 40.07287, 117.09636, 40.07206, 117.09581, 40.07145, 117.09560, 40.07142, 117.09567, 40.07176,
          117.09737, 40.07416, 117.09468, 40.07485, 117.09435, 40.07443, 117.09174, 40.07468, 117.09090, 40.07341,
          117.07907, 40.07370, 117.07868, 40.06726, 117.07665, 40.06715, 117.07669, 40.06406, 117.07644, 40.06405,
          117.07635, 40.06376, 117.07445, 40.06367, 117.07452, 40.06739, 117.06768, 40.06662, 117.06756, 40.06683,
          117.06518, 40.06652, 117.06313, 40.06615, 117.06412, 40.06277, 117.05788, 40.06138, 117.05776, 40.06123,
          117.05815, 40.06031, 117.05713, 40.06019, 117.05611, 40.06031, 117.05575, 40.06049, 117.05470, 40.05870,
          117.05140, 40.05922, 117.04895, 40.05936, 117.04879, 40.05915, 117.04884, 40.05781, 117.04690, 40.05823,
          117.04552, 40.05836, 117.04625, 40.05348, 117.04632, 40.05336, 117.04729, 40.05334, 117.04728, 40.05223,
          117.04711, 40.05165, 117.04469, 40.05097, 117.04494, 40.04972, 117.03828, 40.04902, 117.03693, 40.04979,
          117.03620, 40.04936, 117.03222, 40.04802, 117.03170, 40.04753, 117.02912, 40.04343, 117.02676, 40.04102,
          117.02068, 40.03751, 117.02214, 40.03264, 117.01746, 40.03241, 117.01859, 40.02888, 117.01542, 40.02833,
          117.01456, 40.03115, 117.01166, 40.03048, 117.01174, 40.02918, 117.01124, 40.02920, 117.00829, 40.02948,
          117.00789, 40.03158, 117.00777, 40.03160, 117.00482, 40.03130, 117.00501, 40.02995, 117.00137, 40.02966,
          117.00122, 40.02926, 116.99387, 40.02862, 116.99390, 40.03101, 116.99076, 40.03242, 116.98876, 40.03399,
          116.98660, 40.03524, 116.98001, 40.03758, 116.97403, 40.03742, 116.97220, 40.03722, 116.96591, 40.03581,
          116.96504, 40.03487, 116.96418, 40.03552, 116.96318, 40.03662, 116.96273, 40.03753, 116.96449, 40.03870,
          116.96374, 40.04204, 116.96627, 40.04258, 116.96629, 40.04336, 116.96474, 40.04321, 116.96318, 40.04744,
          116.95881, 40.04670, 116.95819, 40.04969, 116.95590, 40.04966, 116.95585, 40.05023, 116.95443, 40.04998,
          116.94460, 40.04341, 116.94442, 40.04358, 116.93925, 40.04032, 116.93898, 40.04755, 116.93839, 40.04754,
          116.93846, 40.04323, 116.93754, 40.04298, 116.93716, 40.04747, 116.93554, 40.04758, 116.93525, 40.04694,
          116.93449, 40.04609, 116.93325, 40.04502, 116.93284, 40.04491, 116.93189, 40.04545, 116.93163, 40.04583,
          116.93266, 40.04718, 116.93025, 40.04726, 116.93023, 40.04822, 116.93293, 40.04824, 116.93281, 40.04980,
          116.93001, 40.04964, 116.92972, 40.04975, 116.92948, 40.05033, 116.92905, 40.05033, 116.92867, 40.05131,
          116.92667, 40.05095, 116.92661, 40.05109, 116.92571, 40.05095, 116.92443, 40.05426, 116.92212, 40.05386,
          116.92291, 40.05012, 116.92208, 40.05010, 116.92156, 40.05202, 116.92059, 40.05193, 116.92090, 40.05035,
          116.91944, 40.05036, 116.91943, 40.04900, 116.91896, 40.04897, 116.91901, 40.04756, 116.91819, 40.04698,
          116.91819, 40.04641, 116.91331, 40.04510, 116.91330, 40.04411, 116.91202, 40.04365, 116.91099, 40.04653,
          116.91094, 40.04782, 116.90945, 40.04706, 116.90828, 40.05154, 116.90386, 40.05144, 116.90274, 40.05116,
          116.90254, 40.05179, 116.90212, 40.05175, 116.90226, 40.05100, 116.90048, 40.05038, 116.89928, 40.04926,
          116.89799, 40.04866, 116.89542, 40.04667, 116.89563, 40.04638, 116.89377, 40.04636, 116.88644, 40.04532,
          116.88647, 40.04449, 116.88595, 40.04357, 116.88565, 40.04413, 116.88432, 40.04492, 116.88140, 40.04491,
          116.87701, 40.04455, 116.87568, 40.04477, 116.87480, 40.04511, 116.87276, 40.04340, 116.86912, 40.04113,
          116.86766, 40.04045, 116.86473, 40.03998, 116.86469, 40.04068, 116.86187, 40.04079, 116.85496, 40.04828,
          116.85195, 40.04841, 116.85010, 40.04899, 116.85184, 40.05080, 116.84699, 40.05288, 116.84422, 40.05387,
          116.84351, 40.05083, 116.84103, 40.05082, 116.83442, 40.05033, 116.82548, 40.05007, 116.82571, 40.04735,
          116.82474, 40.04696, 116.82456, 40.04711, 116.82269, 40.04687, 116.82271, 40.04628, 116.81671, 40.04532,
          116.81718, 40.04119, 116.81713, 40.03869, 116.81429, 40.03856, 116.81429, 40.03825, 116.81469, 40.03798,
          116.81479, 40.03763, 116.81469, 40.03143, 116.81512, 40.03141, 116.81507, 40.02971, 116.81578, 40.02963,
          116.81571, 40.02880, 116.81394, 40.02916, 116.81396, 40.02719, 116.80916, 40.02749, 116.80926, 40.02975,
          116.80593, 40.03005, 116.80603, 40.03098, 116.80568, 40.03114, 116.80472, 40.02984, 116.79731, 40.03097,
          116.79564, 40.02862, 116.79492, 40.02880, 116.79419, 40.02766, 116.78345, 40.03111, 116.78414, 40.03328,
          116.78238, 40.03338, 116.78017, 40.03382, 116.77974, 40.03370, 116.77680, 40.03380, 116.77545, 40.03360,
          116.77388, 40.03277, 116.77171, 40.03123, 116.77138, 40.02599, 116.76933, 40.02512, 116.76998, 40.02454,
          116.77018, 40.02407, 116.76955, 40.02046, 116.76847, 40.01816, 116.76768, 40.01590, 116.76483, 40.01200,
          116.76437, 40.01041, 116.76495, 40.00850, 116.76565, 40.00717, 116.76822, 40.00409, 116.76966, 40.00172,
          116.77005, 39.99646, 116.76927, 39.99154, 116.76440, 39.98602, 116.76236, 39.98350, 116.76066, 39.98105,
          116.76034, 39.97513, 116.75774, 39.97157, 116.75690, 39.97072, 116.75484, 39.96971, 116.75352, 39.96870,
          116.75203, 39.96691, 116.75127, 39.96476, 116.75111, 39.96206, 116.75124, 39.96025, 116.75238, 39.95821,
          116.75673, 39.95479, 116.76320, 39.95218, 116.76769, 39.95135, 116.77077, 39.94995, 116.77450, 39.94851,
          116.77649, 39.94635, 116.77690, 39.94229, 116.77724, 39.93483, 116.77716, 39.93307, 116.77670, 39.93180,
          116.77629, 39.92707, 116.77671, 39.91798, 116.77663, 39.91370, 116.77609, 39.90921, 116.77762, 39.90425,
          116.77816, 39.90102, 116.77819, 39.89556, 116.77863, 39.89022, 116.77930, 39.88833, 116.78101, 39.88563,
          116.78248, 39.88448, 116.78739, 39.88157, 116.78781, 39.88085, 116.78869, 39.88006, 116.79022, 39.87934,
          116.79224, 39.87892, 116.79387, 39.87772, 116.79478, 39.87734, 116.79810, 39.87676, 116.79821, 39.88370,
          116.80221, 39.88374, 116.80227, 39.88846, 116.80627, 39.88855, 116.80709, 39.88014, 116.80978, 39.88015,
          116.81100, 39.87750, 116.81361, 39.87786, 116.81767, 39.87800, 116.81912, 39.87755, 116.82128, 39.87593,
          116.82407, 39.87220, 116.82624, 39.86859, 116.83091, 39.86362, 116.83343, 39.86467, 116.83794, 39.85981,
          116.84128, 39.85753, 116.84236, 39.85785, 116.84659, 39.85796, 116.84722, 39.85610, 116.84759, 39.85614,
          116.84788, 39.85421, 116.84914, 39.85377, 116.85122, 39.84859, 116.85123, 39.84780, 116.85235, 39.84739,
          116.85958, 39.84585, 116.86012, 39.84283, 116.86224, 39.84255, 116.86599, 39.84088, 116.86611, 39.84088,
          116.86623, 39.84127, 116.86790, 39.84134, 116.86776, 39.84265, 116.87042, 39.84214, 116.87271, 39.84120,
          116.87236, 39.84236, 116.87238, 39.84416, 116.87772, 39.84447, 116.87975, 39.84354, 116.88571, 39.83758,
          116.88700, 39.83471, 116.88868, 39.83313, 116.89159, 39.83154, 116.89433, 39.83056, 116.89743, 39.82965,
          116.89914, 39.82958, 116.90078, 39.83032, 116.90152, 39.83163, 116.90165, 39.83307, 116.89957, 39.83722,
          116.89801, 39.83874, 116.89697, 39.84030, 116.89633, 39.84223, 116.89601, 39.84408, 116.89614, 39.84581,
          116.89633, 39.84657, 116.89690, 39.84721, 116.90281, 39.84783, 116.90273, 39.84919, 116.90445, 39.84956,
          116.90806, 39.84790, 116.91150, 39.84586, 116.91547, 39.84165, 116.91831, 39.83732, 116.91994, 39.83435,
          116.92106, 39.83082, 116.92159, 39.82798, 116.92204, 39.82351, 116.92291, 39.81986, 116.92304, 39.81827,
          116.92283, 39.81546, 116.92234, 39.81394, 116.92224, 39.81310, 116.92252, 39.81202, 116.92305, 39.81113,
          116.92383, 39.81031, 116.92928, 39.80664, 116.93267, 39.80384, 116.93449, 39.80291, 116.93638, 39.80239,
          116.93686, 39.80054, 116.93382, 39.80032, 116.93350, 39.80058, 116.93097, 39.80047, 116.93077, 39.80013,
          116.92884, 39.80008, 116.93074, 39.79535, 116.92982, 39.79503, 116.93031, 39.79403, 116.93129, 39.79414,
          116.93234, 39.79206, 116.93374, 39.79215, 116.94267, 39.79035, 116.94420, 39.79057, 116.94482, 39.79043,
          116.94629, 39.78921, 116.94661, 39.78870, 116.94758, 39.78647, 116.94782, 39.78555, 116.94778, 39.78497,
          116.94557, 39.78524, 116.94197, 39.78434, 116.94373, 39.77746, 116.94016, 39.77632, 116.93979, 39.77629,
          116.93971, 39.77704, 116.93989, 39.77815, 116.93664, 39.77741, 116.93570, 39.77885, 116.93330, 39.78028,
          116.92782, 39.78075, 116.91837, 39.78021, 116.91579, 39.77958, 116.91310, 39.77775, 116.91057, 39.77489,
          116.91240, 39.77151, 116.91498, 39.76812, 116.90967, 39.76501, 116.90809, 39.76449, 116.90852, 39.76382,
          116.90812, 39.76355, 116.90960, 39.76201, 116.90952, 39.76184, 116.90755, 39.76119, 116.90781, 39.76047,
          116.90756, 39.76038, 116.90469, 39.76124, 116.90237, 39.76568, 116.90086, 39.76424, 116.89800, 39.76315,
          116.89591, 39.76259, 116.89650, 39.75809, 116.89368, 39.75773, 116.89365, 39.75759, 116.89564, 39.75417,
          116.90134, 39.75492, 116.90132, 39.75284, 116.90209, 39.75261, 116.90173, 39.75063, 116.90334, 39.75036,
          116.90386, 39.74758, 116.90485, 39.74779, 116.90500, 39.74692, 116.90594, 39.74692, 116.90726, 39.74493,
          116.90596, 39.74386, 116.90637, 39.74295, 116.90685, 39.74325, 116.90853, 39.74072, 116.90476, 39.73991,
          116.90516, 39.73695, 116.90671, 39.73711, 116.90702, 39.73465, 116.91043, 39.73484, 116.91080, 39.73036,
          116.90529, 39.73047, 116.90088, 39.72971, 116.90010, 39.72932, 116.89638, 39.72838, 116.89665, 39.72664,
          116.89385, 39.72649, 116.89385, 39.72513, 116.89368, 39.72506, 116.88919, 39.72458, 116.88770, 39.72422,
          116.88630, 39.72445, 116.88168, 39.72448, 116.88082, 39.72195, 116.87945, 39.72198, 116.87866, 39.71888,
          116.87686, 39.71762, 116.87685, 39.71738, 116.87862, 39.71508, 116.88066, 39.71540, 116.88122, 39.71328,
          116.88003, 39.71312, 116.88115, 39.71179, 116.88047, 39.70597, 116.88130, 39.70598, 116.88228, 39.70174,
          116.88065, 39.70100, 116.88119, 39.70035, 116.88318, 39.69916, 116.88445, 39.69987, 116.88491, 39.69858,
          116.88579, 39.69846, 116.88664, 39.69721, 116.88608, 39.69686, 116.88795, 39.69485, 116.88652, 39.69417,
          116.88784, 39.69232, 116.88192, 39.68992, 116.88401, 39.68663, 116.88553, 39.68677, 116.88459, 39.68799,
          116.88661, 39.68896, 116.88704, 39.68806, 116.88726, 39.68799, 116.89699, 39.68956, 116.89712, 39.68872,
          116.89890, 39.68877, 116.90005, 39.68689, 116.90668, 39.68820, 116.90621, 39.69023, 116.90640, 39.69024,
          116.90626, 39.69144, 116.90546, 39.69185, 116.90538, 39.69440, 116.90582, 39.69444, 116.90586, 39.69421,
          116.90765, 39.69441, 116.90693, 39.69682, 116.90962, 39.69723, 116.91383, 39.69501, 116.91361, 39.69717,
          116.91095, 39.69831, 116.91038, 39.70276, 116.91100, 39.70273, 116.91101, 39.70535, 116.91407, 39.70574,
          116.92194, 39.70520, 116.92465, 39.70536, 116.92645, 39.70566, 116.92675, 39.70460, 116.92725, 39.70456,
          116.92741, 39.70395, 116.92848, 39.70414, 116.92887, 39.70249, 116.93002, 39.70248, 116.93030, 39.70324,
          116.93072, 39.70361, 116.93161, 39.70491, 116.93172, 39.70535, 116.94485, 39.70574, 116.94646, 39.70027,
          116.94665, 39.69857, 116.94527, 39.69838, 116.94390, 39.70184, 116.94238, 39.70175, 116.94201, 39.70058,
          116.93969, 39.69714, 116.93973, 39.69598, 116.93890, 39.69447, 116.93860, 39.69407, 116.93758, 39.69415,
          116.93717, 39.69337, 116.93720, 39.69274, 116.93762, 39.69173, 116.93877, 39.68979, 116.93827, 39.68910,
          116.93848, 39.68892, 116.93885, 39.68736, 116.93837, 39.68692, 116.93814, 39.68643, 116.93816, 39.68574,
          116.93901, 39.68359, 116.93978, 39.68221, 116.94050, 39.68138, 116.94109, 39.68162, 116.94297, 39.67934,
          116.94337, 39.67956, 116.94546, 39.67707, 116.94477, 39.67623, 116.93949, 39.67554, 116.93973, 39.67406,
          116.93928, 39.67395, 116.93975, 39.67259, 116.93971, 39.66972, 116.95149, 39.66516, 116.94990, 39.66078,
          116.94933, 39.65757, 116.95026, 39.65504, 116.95172, 39.64997, 116.95370, 39.64662, 116.95636, 39.64307,
          116.95692, 39.64261, 116.95758, 39.64235, 116.95833, 39.64248, 116.95894, 39.64332, 116.96209, 39.64522,
          116.96342, 39.64643, 116.96429, 39.64760, 116.96459, 39.64776, 116.96531, 39.64776, 116.96600, 39.64743,
          116.96861, 39.64553, 116.96906, 39.64486, 116.96927, 39.64371, 116.96892, 39.63816, 116.96721, 39.63790,
          116.96848, 39.63566, 116.96950, 39.63585, 116.97095, 39.63522, 116.97249, 39.63620, 116.97383, 39.63680,
          116.97451, 39.63691, 116.97485, 39.63680, 116.97734, 39.63743, 116.97758, 39.63757, 116.97758, 39.63788,
          116.98252, 39.63934, 116.98393, 39.63775, 116.98506, 39.63797, 116.98377, 39.64031, 116.99819, 39.64329,
          116.99806, 39.64449, 117.00126, 39.64510, 117.00109, 39.64620, 117.00180, 39.64635, 117.00165, 39.64736,
          117.00325, 39.64751, 117.00329, 39.64724, 117.00397, 39.64733, 117.00401, 39.64697, 117.00531, 39.64701,
          117.00502, 39.64995, 117.00954, 39.65072, 117.00950, 39.65281, 117.01772, 39.65141, 117.02680, 39.64937,
          117.03113, 39.64771, 117.03450, 39.64664, 117.03912, 39.64548, 117.04283, 39.64489, 117.05064, 39.64322,
          117.05516, 39.64188, 117.06068, 39.63987, 117.07212, 39.63652, 117.08179, 39.63211, 117.08747, 39.63014,
          117.09444, 39.62827, 117.09401, 39.62747, 117.09681, 39.62654, 117.09678, 39.62377, 117.10114, 39.62416,
          117.10193, 39.62139, 117.10249, 39.62147, 117.10226, 39.62426, 117.10587, 39.62302, 117.10617, 39.61999,
          117.10869, 39.61999, 117.10886, 39.61961, 117.10973, 39.61973, 117.10996, 39.61924, 117.11083, 39.61930,
          117.11110, 39.61769, 117.11470, 39.61780, 117.11416, 39.62024, 117.11440, 39.62027, 117.11537, 39.61591,
          117.12078, 39.61559, 117.12089, 39.61547, 117.12299, 39.61575, 117.12249, 39.61656, 117.11940, 39.61642,
          117.11761, 39.61917, 117.11783, 39.61954, 117.11817, 39.61943, 117.11861, 39.62054, 117.12428, 39.61872,
          117.12961, 39.61672, 117.12984, 39.61705, 117.13129, 39.61775, 117.13361, 39.61960, 117.13918, 39.61933,
          117.13973, 39.61951, 117.14009, 39.62003, 117.13978, 39.62108, 117.14175, 39.62131, 117.14619, 39.62218,
          117.14571, 39.62449, 117.14771, 39.62471, 117.14550, 39.62599, 117.14382, 39.62730, 117.14433, 39.62947,
          117.14779, 39.62948, 117.14827, 39.62973, 117.15150, 39.63527, 117.15297, 39.63528, 117.15663, 39.63475,
          117.16182, 39.63491, 117.16177, 39.63543, 117.16641, 39.63546, 117.16659, 39.63991, 117.16779, 39.64008,
          117.16796, 39.64134, 117.17149, 39.64168, 117.17126, 39.64433, 117.16485, 39.64542, 117.16264, 39.64684,
          117.16282, 39.65049, 117.15994, 39.65026, 117.16001, 39.65169, 117.15758, 39.65042, 117.15759, 39.65277,
          117.15671, 39.65273, 117.15670, 39.65412, 117.15648, 39.65418, 117.15643, 39.65524, 117.15671, 39.65538,
          117.15702, 39.65748, 117.15643, 39.65749, 117.15669, 39.65873, 117.15551, 39.65873, 117.15525, 39.65735,
          117.15433, 39.65736, 117.15445, 39.65902, 117.15302, 39.65925, 117.15297, 39.65989, 117.15246, 39.65990,
          117.15229, 39.66269, 117.15346, 39.66270, 117.15316, 39.66552, 117.15340, 39.66565, 117.15557, 39.66565,
          117.15822, 39.66539, 117.15819, 39.66778, 117.16014, 39.66848, 117.15970, 39.67165, 117.16368, 39.67206,
          117.16227, 39.68106, 117.16168, 39.68101, 117.16152, 39.68167, 117.16142, 39.68227, 117.16190, 39.68234,
          117.16128, 39.68556, 117.16349, 39.68582, 117.16323, 39.68786, 117.16393, 39.68794, 117.16302, 39.69691,
          117.16422, 39.69745, 117.16484, 39.69995, 117.16381, 39.70028, 117.16256, 39.70130, 117.16260, 39.70221,
          117.16218, 39.70219, 117.16217, 39.70290, 117.16418, 39.70304, 117.16367, 39.70382, 117.16210, 39.70376,
          117.16186, 39.70684, 117.16426, 39.70699, 117.16271, 39.71221, 117.16020, 39.71202, 117.16024, 39.71083,
          117.15784, 39.71050, 117.15713, 39.71448, 117.15885, 39.71506, 117.15919, 39.71548, 117.15922, 39.71616,
          117.16277, 39.71627, 117.16237, 39.71839, 117.16189, 39.71918, 117.16173, 39.72022, 117.15987, 39.72087,
          117.15963, 39.71749, 117.15891, 39.71742, 117.15900, 39.71662, 117.15860, 39.71660, 117.15835, 39.71749,
          117.15804, 39.71750, 117.15772, 39.71909, 117.15426, 39.71946, 117.15422, 39.72082, 117.15086, 39.72087,
          117.15086, 39.72133, 117.15247, 39.72170, 117.15241, 39.72205, 117.14672, 39.72139, 117.14664, 39.72261,
          117.14882, 39.72790, 117.14685, 39.72849, 117.14799, 39.73061, 117.14790, 39.73119, 117.14752, 39.73136,
          117.14751, 39.73229, 117.14668, 39.73213, 117.14719, 39.73497, 117.15405, 39.73513, 117.15359, 39.73681,
          117.15396, 39.73730, 117.15392, 39.73768, 117.15480, 39.73760, 117.15658, 39.73705, 117.15721, 39.73666,
          117.15780, 39.73588, 117.15818, 39.73566, 117.15878, 39.73565, 117.15906, 39.73581, 117.15967, 39.73670,
          117.15901, 39.73753, 117.15872, 39.73907, 117.15755, 39.74139, 117.15604, 39.74366, 117.15565, 39.74479,
          117.15542, 39.74680, 117.15656, 39.74856, 117.15696, 39.74846, 117.15780, 39.74910, 117.15838, 39.74919,
          117.15975, 39.74844, 117.16077, 39.74821, 117.16282, 39.74894, 117.16287, 39.74916, 117.16664, 39.75057,
          117.16997, 39.75087, 117.17134, 39.75051, 117.17481, 39.75089, 117.17833, 39.75061, 117.17855, 39.75128,
          117.17890, 39.75155, 117.18052, 39.75451, 117.18415, 39.75386, 117.18643, 39.75370, 117.18812, 39.75696,
          117.18857, 39.75856, 117.19135, 39.75782, 117.19172, 39.75903, 117.19536, 39.75864, 117.19952, 39.76258,
          117.19367, 39.76739, 117.19241, 39.76903, 117.19229, 39.77070, 117.19104, 39.77076, 117.19081, 39.77044,
          117.18676, 39.77392, 117.18210, 39.77651, 117.17845, 39.77799, 117.17606, 39.77962, 117.17603, 39.78056,
          117.17525, 39.78049, 117.17420, 39.78115, 117.17406, 39.78480, 117.17357, 39.78525, 117.17357, 39.78581,
          117.17314, 39.78750, 117.17301, 39.78975, 117.17231, 39.79404, 117.17000, 39.79386, 117.16993, 39.79456,
          117.16932, 39.79460, 117.16900, 39.79619, 117.16549, 39.79595, 117.16482, 39.79848, 117.16132, 39.79834,
          117.15942, 39.79538, 117.15865, 39.79631, 117.15808, 39.79669, 117.15650, 39.79722, 117.15573, 39.79712,
          117.15538, 39.79692, 117.15507, 39.79559, 117.15103, 39.79538, 117.15057, 39.80100, 117.15112, 39.80111,
          117.15068, 39.80541, 117.15368, 39.80512, 117.15375, 39.80568, 117.15520, 39.80568, 117.15037, 39.81439,
          117.14986, 39.81613, 117.15116, 39.81634, 117.15142, 39.81806, 117.15239, 39.81821, 117.15261, 39.82052,
          117.15342, 39.81941, 117.15606, 39.81648, 117.15822, 39.81756, 117.16074, 39.81787, 117.16070, 39.82240,
          117.16447, 39.82266, 117.16465, 39.82300, 117.17072, 39.82351, 117.17434, 39.82355, 117.17472, 39.82419,
          117.18413, 39.82508, 117.18505, 39.82388, 117.18749, 39.82438, 117.18867, 39.82421, 117.18799, 39.82669,
          117.18675, 39.82960, 117.18643, 39.82958, 117.18576, 39.83180, 117.19137, 39.83252, 117.19253, 39.83307,
          117.19346, 39.83332, 117.19428, 39.83132, 117.20097, 39.83373, 117.20205, 39.83013, 117.20402, 39.83087,
          117.20609, 39.83104, 117.20811, 39.83081, 117.21375, 39.82938, 117.21430, 39.82595, 117.21791, 39.82729,
          117.21987, 39.82971, 117.22090, 39.83033, 117.22316, 39.83117, 117.22735, 39.83236, 117.22963, 39.83269,
          117.23102, 39.83268, 117.23825, 39.83137, 117.25019, 39.82855, 117.25086, 39.82856, 117.25010, 39.83015,
          117.25007, 39.83074, 117.24979, 39.83127, 117.24926, 39.83151, 117.24715, 39.83076, 117.24611, 39.83083,
          117.24539, 39.83200, 117.24527, 39.83261, 117.24549, 39.83306, 117.24586, 39.83336, 117.24816, 39.83404,
          117.24875, 39.83457, 117.24893, 39.83502, 117.24888, 39.83541, 117.24705, 39.83684, 117.24697, 39.83724,
          117.24701, 39.83755, 117.24858, 39.83911, 117.24920, 39.84143, 117.25014, 39.84167, 117.25127, 39.84141,
          117.25249, 39.84143, 117.25321, 39.84170, 117.25359, 39.84215, 117.25361, 39.84278, 117.25334, 39.84328,
          117.25181, 39.84488, 117.25118, 39.84607, 117.25093, 39.84707, 117.24920, 39.84844, 117.24757, 39.85119,
          117.24568, 39.85365, 117.24532, 39.85430, 117.24554, 39.85536, 117.24550, 39.85604, 117.24526, 39.85658,
          117.24214, 39.85915, 117.24108, 39.85982, 117.23956, 39.86009, 117.23791, 39.86005, 117.23501, 39.85940,
          117.23343, 39.85921, 117.23233, 39.85822, 117.23178, 39.85563, 117.23151, 39.85514, 117.23052, 39.85455,
          117.22886, 39.85448, 117.22818, 39.85467, 117.22609, 39.85575, 117.22521, 39.85586, 117.22449, 39.85566,
          117.22381, 39.85505, 117.22356, 39.85442, 117.22336, 39.85215, 117.22309, 39.85178, 117.22255, 39.85156,
          117.22143, 39.85153, 117.21658, 39.85417, 117.21368, 39.85530, 117.21133, 39.85579, 117.21043, 39.85577,
          117.20680, 39.85501, 117.20606, 39.85512, 117.20566, 39.85550, 117.20545, 39.85609, 117.20523, 39.85825,
          117.20473, 39.85866, 117.20083, 39.85888, 117.19856, 39.85938, 117.19437, 39.86082, 117.19333, 39.86100,
          117.19273, 39.86103, 117.19191, 39.86080, 117.19016, 39.85990, 117.18872, 39.85983, 117.18770, 39.85997,
          117.18678, 39.86031, 117.18597, 39.86082, 117.18270, 39.86411, 117.18119, 39.86513, 117.18056, 39.86533,
          117.17984, 39.86533, 117.17932, 39.86513, 117.17833, 39.86368, 117.17718, 39.86285, 117.17552, 39.86256,
          117.17439, 39.86281, 117.17385, 39.86315, 117.17367, 39.86396, 117.17493, 39.86603, 117.17486, 39.86733,
          117.17461, 39.86790, 117.17196, 39.86959, 117.17141, 39.86957, 117.17071, 39.86925, 117.17018, 39.86871,
          117.16986, 39.86783, 117.16977, 39.86661, 117.16913, 39.86551, 117.16844, 39.86510, 117.16763, 39.86485,
          117.16538, 39.86476, 117.16197, 39.86535, 117.16026, 39.86646, 117.16005, 39.86682, 117.16008, 39.86727,
          117.16038, 39.86761, 117.16738, 39.87173, 117.16795, 39.87229, 117.16803, 39.87340, 117.16768, 39.87401,
          117.16571, 39.87531, 117.16407, 39.87619, 117.16357, 39.87617, 117.16330, 39.87583, 117.16328, 39.87405,
          117.16276, 39.87313, 117.16170, 39.87170, 117.16061, 39.87113, 117.15919, 39.87119, 117.15817, 39.87147,
          117.15782, 39.87198, 117.15710, 39.87395, 117.15614, 39.87550, 117.15128, 39.87739, 117.15038, 39.87685,
          117.14981, 39.87607, 117.14818, 39.87510, 117.14719, 39.87426, 117.14636, 39.87412, 117.14599, 39.87443,
          117.14576, 39.87537, 117.14567, 39.87610, 117.14588, 39.87680, 117.14644, 39.87791, 117.14712, 39.87863,
          117.14811, 39.88010, 117.14873, 39.88210, 117.14889, 39.88357, 117.14915, 39.88406, 117.15017, 39.88575,
          117.15165, 39.88743, 117.15193, 39.88796, 117.15059, 39.88916, 117.14491, 39.89346, 117.14262, 39.89491,
          117.14182, 39.89604, 117.14168, 39.89735, 117.14227, 39.89925, 117.14406, 39.90068, 117.15110, 39.90323,
          117.15238, 39.90512, 117.15267, 39.90694, 117.15235, 39.90785, 117.15103, 39.90880, 117.14908, 39.90920,
          117.14680, 39.90897, 117.14185, 39.90881, 117.14006, 39.90907, 117.13898, 39.90954, 117.13826, 39.91020,
          117.13779, 39.91152, 117.13760, 39.91363, 117.13601, 39.91741, 117.13529, 39.91768, 117.13351, 39.91777,
          117.13020, 39.91825, 117.12945, 39.91854, 117.12931, 39.91897, 117.12940, 39.91957, 117.13008, 39.92012,
          117.13516, 39.92036, 117.13701, 39.92071, 117.14338, 39.92287, 117.14352, 39.92335, 117.14215, 39.92426,
          117.14119, 39.92536, 117.14097, 39.92729, 117.13959, 39.93018, 117.13960, 39.93120, 117.13990, 39.93176,
          117.14275, 39.93421, 117.14347, 39.93450, 117.14423, 39.93467, 117.14503, 39.93454, 117.14584, 39.93425,
          117.14855, 39.93278, 117.14929, 39.93288, 117.14991, 39.93330, 117.15089, 39.93458, 117.15095, 39.93544,
          117.15038, 39.93668, 117.14706, 39.94068, 117.14420, 39.94277, 117.14198, 39.94257, 117.14109, 39.94286,
          117.13942, 39.94477, 117.14045, 39.94590, 117.14183, 39.94522, 117.14454, 39.94349, 117.14524, 39.94414,
          117.14598, 39.94527, 117.14671, 39.94571, 117.14715, 39.94627, 117.14936, 39.94751, 117.15216, 39.94941,
          117.15509, 39.95042, 117.15805, 39.95073, 117.15979, 39.95308, 117.16001, 39.95357, 117.15994, 39.95403,
          117.15905, 39.95556, 117.15880, 39.95628, 117.15846, 39.95853, 117.15872, 39.96004, 117.15782, 39.96134,
          117.15794, 39.96159, 117.15840, 39.96178, 117.15609, 39.96331, 117.15442, 39.96380, 117.15434, 39.96429,
          117.15504, 39.96466, 117.15979, 39.96160, 117.16138, 39.96213, 117.16152, 39.96243, 117.16475, 39.96241,
          117.16594, 39.96174, 117.16743, 39.95792, 117.16948, 39.95779, 117.16988, 39.95924, 117.17190, 39.96267,
          117.17268, 39.96312, 117.17250, 39.96372, 117.17322, 39.96428, 117.17366, 39.96819, 117.17212, 39.96828,
          117.17203, 39.96878, 117.17234, 39.96956, 117.17302, 39.96956, 117.17217, 39.97597, 117.17319, 39.97603,
          117.17324, 39.97644, 117.17444, 39.97649, 117.17512, 39.97684, 117.17908, 39.97664, 117.17920, 39.97717,
          117.18169, 39.97750, 117.18157, 39.97904, 117.18327, 39.97910, 117.18318, 39.98046, 117.18472, 39.98052,
          117.18446, 39.98517, 117.18696, 39.98522, 117.18688, 39.98806, 117.18809, 39.98830, 117.18812, 39.98848,
          117.18886, 39.98904, 117.18989, 39.98933, 117.19039, 39.99133, 117.19169, 39.99146, 117.19183, 39.99435,
          117.19126, 39.99446, 117.19123, 39.99487, 117.19092, 39.99492, 117.19124, 39.99724, 117.19063, 39.99739,
          117.19092, 39.99898, 117.19053, 39.99955, 117.19020, 39.99968, 117.19001, 40.00038, 117.18959, 40.00081,
          117.18933, 40.00265, 117.19031, 40.00347, 117.19045, 40.00507, 117.18999, 40.00683, 117.19099, 40.00812,
          117.19125, 40.00930, 117.19084, 40.00970, 117.19029, 40.00979, 117.18994, 40.00960, 117.18979, 40.00916,
          117.18949, 40.00889, 117.18885, 40.00870, 117.18922, 40.01108, 117.18846, 40.01161, 117.18798, 40.01405,
          117.18701, 40.01500, 117.18679, 40.01547, 117.18729, 40.01883, 117.18766, 40.02027, 117.18610, 40.02164,
          117.18498, 40.02233, 117.18355, 40.02256, 117.18268, 40.02288, 117.18213, 40.02337, 117.18137, 40.02456,
          117.18163, 40.02631, 117.18141, 40.02957, 117.18188, 40.03124, 117.18170, 40.03188, 117.18063, 40.03296,
          117.18079, 40.03467, 117.18027, 40.03580, 117.18071, 40.03863, 117.18037, 40.04056, 117.18089, 40.04132,
          117.18094, 40.04200, 117.18065, 40.04235, 117.18087, 40.04371, 117.18123, 40.04447, 117.18052, 40.04512,
          117.18156, 40.04540, 117.18203, 40.04568, 117.18229, 40.04594, 117.18227, 40.04647, 117.18105, 40.04847,
          117.18022, 40.04917, 117.17998, 40.04981, 117.17932, 40.05030, 117.17817, 40.05077, 117.17696, 40.05172,
          117.17686, 40.05229, 117.17764, 40.05332, 117.17764, 40.05376, 117.17661, 40.05530, 117.17549, 40.05658,
          117.17532, 40.05770, 117.17590, 40.05883, 117.17659, 40.05936, 117.17667, 40.06030, 117.17762, 40.06127,
          117.17848, 40.06049, 117.17924, 40.06022, 117.18069, 40.06018, 117.18134, 40.05998, 117.18249, 40.06080,
          117.18300, 40.06088, 117.18558, 40.06019, 117.18529, 40.06283, 117.18595, 40.06430, 117.18593, 40.06497,
          117.18729, 40.06534, 117.18810, 40.06521, 117.18907, 40.06529, 117.19110, 40.06492, 117.19199, 40.06465,
          117.19284, 40.06404, 117.19421, 40.06404, 117.19549, 40.06358, 117.19610, 40.06369, 117.19638, 40.06340,
          117.19671, 40.06246, 117.19714, 40.06232, 117.19819, 40.06240, 117.19877, 40.06277, 117.19942, 40.06270,
          117.20002, 40.06286, 117.20290, 40.06451, 117.20464, 40.06362, 117.20548, 40.06286, 117.20681, 40.06359,
          117.20798, 40.06399, 117.20886, 40.06388, 117.21008, 40.06345, 117.21099, 40.06337, 117.21147, 40.06313,
          117.21255, 40.06316, 117.21331, 40.06331, 117.21439, 40.06383, 117.21585, 40.06391, 117.21647, 40.06426,
          117.21661, 40.06450, 117.21652, 40.06539, 117.21514, 40.06656, 117.21366, 40.06821, 117.21333, 40.06986,
          117.21181, 40.07061, 117.21116, 40.07141, 117.20953, 40.07178, 117.20871, 40.07240, 117.20848, 40.07320,
          117.20793, 40.07389, 117.20782, 40.07461, 117.20714, 40.07537, 117.20662, 40.07814, 117.20565, 40.07908,
          117.20496, 40.08016, 117.20337, 40.08097, 117.20287, 40.08092, 117.20214, 40.08123, 117.20138, 40.08121,
          117.20022, 40.08014, 117.19786, 40.07837, 117.19707, 40.07722, 117.19719, 40.07542, 117.20176, 40.07555,
          117.20155, 40.07425, 117.20066, 40.07226, 117.20022, 40.07170, 117.19919, 40.07129, 117.19912, 40.06954,
          117.19882, 40.06901, 117.19717, 40.06833, 117.19517, 40.06804, 117.19399, 40.06768, 117.19344, 40.06714,
          117.19276, 40.06597, 117.19114, 40.06645, 117.19215, 40.06880, 117.19005, 40.06968, 117.18942, 40.06944,
          117.18774, 40.06984, 117.18692, 40.07068, 117.18657, 40.07131, 117.18584, 40.07142, 117.18541, 40.07167,
          117.18477, 40.07312, 117.18465, 40.07556, 117.18264, 40.07819, 117.18232, 40.07911, 117.18238, 40.07984,
          117.18284, 40.08068, 117.18395, 40.08109, 117.18276, 40.08154, 117.18157, 40.08285, 117.18127, 40.08300,
          117.18038, 40.08293
        ]
        var beisan = []
        for (var i = 0; i < langfang_beisan.length; i++) {
          if (i % 2 == 0) {
            var temp = [langfang_beisan[i], langfang_beisan[i + 1]]
            beisan.push(temp)
          } else {
            continue;
          }
        }
        //==
        var coord3 = [
          []
        ];
        var points =
          "110.989 33.253,111.174 33.117,111.283 32.862,111.574 32.591,111.712 32.608,111.873 32.506,112.306 32.328,112.54 32.406,112.762 32.346,112.868 32.399,113.112 32.378,113.205 32.434,113.422 32.272,113.606 32.363,113.733 32.258,113.854 31.842,114.288 31.754,114.581 31.764,114.639 31.582,114.825 31.461,115.119 31.6,115.205 31.447,115.368 31.407,115.579 31.145,115.707 31.2,116.026 31.011,115.862 30.868,115.758 30.687,115.915 30.518,115.88 30.382,116.053 30.217,116.131 29.825,115.961 29.727,115.663 29.853,115.506 29.843,115.354 29.649,115.226 29.654,115.119 29.512,114.976 29.567,114.864 29.408,114.509 29.326,114.254 29.346,113.937 29.05,113.68 29.09,113.604 29.254,113.734 29.592,113.658 29.687,113.356 29.69,113.139 29.452,112.906 29.61,112.926 29.764,112.645 29.595,112.433 29.635,112.364 29.545,111.909 29.855,111.73 29.924,111.546 29.898,111.237 30.043,110.925 30.066,110.764 30.123,110.487 30.022,110.63 29.763,110.368 29.636,110.114 29.793,109.777 29.761,109.702 29.61,109.524 29.628,109.425 29.53,109.228 29.122,109.106 29.219,109.061 29.403,108.916 29.329,108.882 29.636,108.739 29.659,108.598 29.867,108.514 29.885,108.578 30.259,108.41 30.481,108.694 30.549,108.839 30.509,108.963 30.627,109.146 30.53,109.356 30.553,109.898 30.903,110.146 30.914,110.115 31.092,110.159 31.305,109.919 31.524,109.741 31.58,109.581 31.729,109.635 31.819,109.555 32.221,109.555 32.221,109.498 32.393,109.62 32.599,110.124 32.619,110.096 32.836,109.798 32.879,109.793 32.88,109.787 33.012,109.787 33.013,109.618 33.272,109.619 33.273,110.208 33.164,110.466 33.183,110.707 33.097,110.989 33.253";
        var regionLngLats = [];
        var regionArr = points.split(",");
        for (var m = 0; m < regionArr.length; m++) {
          var lnglatArr = regionArr[m].split(" ");
          var lnglat = [Number(lnglatArr[0]), Number(lnglatArr[1])];
          regionLngLats.push(lnglat);
        }
        var coord4 = [
          regionLngLats
        ];
        for (var i = 0; i < coord4[0].length; i++) {
          coord3[0].push(coord4[0][i]);
        }
        //===
        // console.log([beisan]);
        // console.log(coord3);
        var polygon = new Polygon(coord3);
        // var polygon=new Polygon([beisan]);
        var line_f = new Feature(polygon);
        line_f.setStyle(linestyle);
        var extent = polygon.getExtent();
        var minx_maxy = new Point([extent[0], extent[3]]);
        var maxx_miny = new Point([extent[2], extent[1]]);
        var width = getDistance([extent[0], extent[3]], [extent[2], extent[3]], 6378137);
        var height = getDistance([extent[0], extent[1]], [extent[0], extent[3]], 6378137);
        var unit = 5000;
        var h = height % unit == 0 ? height / unit : height / unit + 1;
        var w = width % unit == 0 ? width / unit : width / unit + 1;
        for (var j = 0; j < h; j++) {
          for (var i = 0; i < w; i++) {
            // var coordinates = [minx_maxy.getCoordinates()[0]+i*unit*0.00001141,minx_maxy.getCoordinates()[1]-j*unit*0.00000899];
            var coordinates = [CommonFunc.caculate.destinationVincenty(minx_maxy.getCoordinates(), 90, i * unit)[0],
              CommonFunc.caculate.destinationVincenty(minx_maxy.getCoordinates(), 180, j * unit)[1]
            ];
            var rectangle = new Polygon([
              [coordinates, [CommonFunc.caculate.destinationVincenty(minx_maxy.getCoordinates(), 90, (i + 1) * unit)[
                  0], CommonFunc.caculate.destinationVincenty(minx_maxy.getCoordinates(), 180, j * unit)[1]],
                [CommonFunc.caculate.destinationVincenty(minx_maxy.getCoordinates(), 90, (i + 1) * unit)[0],
                  CommonFunc.caculate.destinationVincenty(minx_maxy.getCoordinates(), 180, (j + 1) * unit)[1]
                ],
                [CommonFunc.caculate.destinationVincenty(coordinates, 180, unit)[0], CommonFunc.caculate.destinationVincenty(
                  minx_maxy.getCoordinates(), 180, (j + 1) * unit)[1]], coordinates
              ]
            ]);
            var gridFeature = new Feature({
              type: 'grid',
              geometry: rectangle
            });
            gridFeature.setId('' + i + ',' + '' + j + '');
            // featuregrid.push(gridFeature);
            var x = turf.intersect(new GeoJSON().writeGeometryObject(rectangle), new GeoJSON().writeGeometryObject(
              polygon));
            if (x != null) {
              // console.log(x);
              // console.log(new GeoJSON().readFeature(x));
              var y = new GeoJSON().readFeature(x);
              y.setId('' + i + ',' + '' + j + '');
              y.setStyle(gridstyle);
              // console.log(gridFeature);
              geojson.push(x);
              featuregrid.push(y);
            }
          }
        }
        console.log(featuregrid);
        // featuregrid[0].setStyle(onlystyle);
        // featuregrid[1].setStyle(onlystyle);
        // featuregrid[2].setStyle(onlystyle);
        // featuregrid[3].setStyle(onlystyle);
        // featuregrid[4].setStyle(onlystyle);
        featuregrid[5].setStyle(onlystyle);
        // featuregrid[102].setStyle(onlystyle);
        // console.log(geojson);
        //================================================================================
        var styles = {
          'grid': new Style({
            stroke: new Stroke({
              width: 3,
              color: [255, 0, 0, 0.8],
              // lineDash: [0.5, 4]
            }),
            fill: new Fill({
              color: 'rgba(0,255,255,0.4)'
            })
          }),
          'range': new Style({
            stroke: new Stroke({
              width: 3,
              color: [0, 255, 0, 1],
              lineDash: [0.5, 4]
            })
          }),
          'icon': new Style({
            image: new Icon({
              anchor: [0.5, 1],
              scale: 0.1,
              src: require('../../assets/logo.png')
            })
          }),
          'geoMarker': new Style({
            image: new CircleStyle({
              radius: 7,
              fill: new Fill({
                color: 'black'
              }),
              stroke: new Stroke({
                color: 'white',
                width: 2
              })
            })
          })
        };
        var iconFeature = new Feature(new Point(point00));
        iconFeature.setStyle(createStyle(require('../../assets/logo.png'), undefined));
        var layers = [
          new TileLayer({
            // extent: extents.HuBei,
            title: "天地图注记",
            source: new XYZSource({
              url: "http://t2.tianditu.com/DataServer?T=vec_w&x={x}&y={y}&l={z}"
            })
          }),
          new TileLayer({
            // extent: extents.HuBei,
            title: "天地图行政区划",
            source: new XYZSource({
              url: "http://t3.tianditu.com/DataServer?T=cva_w&x={x}&y={y}&l={z}"
            })
          }),
          new VectorLayer({
            source: new VectorSource({
              features: [iconFeature]
            })
          }),
          new VectorLayer({
            source: new VectorSource({
              features: [line_f],
              projection: 'EPSG:4326'
            })
          }),
          new VectorLayer({
            source: new VectorSource({
              features: featuregrid,
              projection: 'EPSG:4326'
            }),
            style: function (feature) {
              return styles[feature.get('type')];
            }
          })
        ];
        map = new Map({
          controls: defaultControls().extend([
            new FullScreen(), mousePositionControl
          ]),
          layers: layers,
          target: 'map',
          view: new View({
            projection: 'EPSG:4326',
            center: [114.30, 30.60],
            zoom: 10,
            maxZoom: 18
          })
        });
        // for(var i=0;i<featuregrid.length;i++){

        // }
        // // change mouse cursor when over marker
        // var select = null; // ref to currently selected interaction
        // var selectClick = new Select({
        //   condition: click
        // });
        // select = selectClick;
        // if (select !== null) {
        //   map.removeInteraction(select);
        // }
        // map.addInteraction(selectClick);
        // select.on('select', function(e) {
        //   var features=e.target.getFeatures().getArray();
        //   if(features.length>0){
        //   console.log(features);//获取ID
        //   features[0].setStyle(onlystyle);
        //   alert(features[0].getId());
        //   }
        // })
        // display popup on click
        var element = document.getElementById('popup');
        var content = document.getElementById('popup-content');
        var popup = new Overlay({
          element: element,
          positioning: 'bottom-center',
          stopEvent: false,
          offset: [0, 0]
        });
        map.addOverlay(popup);
        map.on('click', function (evt) {
          var feature = map.forEachFeatureAtPixel(evt.pixel,
            function (feature) {
              return feature;
            });
          if (feature) {
            element.style.display = "block";
            var id = feature.getId();
            feature.setStyle(onlystyle);
            var coordinates = feature.getGeometry().getFirstCoordinate();
            content.innerHTML = id;
            popup.setPosition(coordinates);
            // map.getView().setCenter(coordinates);
            // $(element).popover({
            //   placement: 'top',
            //   html: true,
            //   content: id
            // });
            // $(element).popover('show');
          } else {
            // $(element).popover('destroy');
            element.style.display = "none";
          }
        });
        map.on('pointermove', function (evt) {
          if (evt.dragging) {
            $(element).popover('destroy');
            return;
          }
          map.getTargetElement().style.cursor =
            map.hasFeatureAtPixel(evt.pixel) ? 'pointer' : '';
        });
      }
    },
    watch: {

    }
  }

</script>

<!-- Add "scoped" attribute to limit CSS to this component only -->
<style scoped>
  .grid_map {
    height: 100%;
    width: 100%;
  }

  #mouse-position {
    float: left;
    position: absolute;
    bottom: 5px;
    width: 200px;
    height: 20px;
    /* 将z-index设置为显示在地图上层 */
    z-index: 2000;
  }

</style>
<style>
  /* 显示鼠标信息的自定义样式设置 */

  .custom-mouse-position {
    color: red;
    font-size: 16px;
    font-family: "微软雅黑";
  }

  .ol-popup {
    position: absolute;
    background-color: white;
    -webkit-filter: drop-shadow(0 1px 4px rgba(0, 0, 0, 0.2));
    filter: drop-shadow(0 1px 4px rgba(0, 0, 0, 0.2));
    padding: 15px;
    border-radius: 10px;
    border: 1px solid #cccccc;
    bottom: 12px;
    left: -35px;
    min-width: 50px;
  }

  .ol-popup:after,
  .ol-popup:before {
    top: 100%;
    border: solid transparent;
    content: " ";
    height: 0;
    width: 0;
    position: absolute;
    pointer-events: none;
  }

  .ol-popup:after {
    border-top-color: white;
    border-width: 10px;
    left: 50%;
    margin-left: -10px;
  }

  .ol-popup:before {
    border-top-color: #cccccc;
    border-width: 11px;
    left: 50%;
    margin-left: -11px;
  }

</style>
